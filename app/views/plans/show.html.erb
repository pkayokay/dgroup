<% if @plan.persisted? %>
  <div class="flex justify-between items-center mb-4">
    <h1>
      <%= @plan.plan_type.humanize.titleize %>
    </h1>
    <p>
      <%= format_date(@plan.start_date) %>
    </p>
  </div>
  <div class="divide-y divide-gray-200">
    <%= button_to "Delete plan", @plan, method: :delete, data: { turbo_confirm: "Are you sure you want to delete this plan?" }, class: "btn btn-danger" %>
    <%= form_with model: @plan do |form| %>
    <%= form.label :start_date, "Start date" %><br />
      <%= form.date_field :start_date, value: @plan.start_date, required: true %>
      <%= form.submit %>
    <% end %>
    <% @plan.weeks.each do |week| %>
      <div class="py-4">
        <p class="mb-4">
          <%= week.position %>. <%= format_date_range(week.start_date, week.end_date) %>
        </p>
        <div>
        <% week.chapters_data.each do |chapter| %>
          <p>
            <%= chapter["reference"] %>
            <%= chapter["completed"] %>
          </p>
        <% end %>

        <div class="mt-4">
          Memory verse:<br />
          <%= week.memory_verse_reference %>
          <%= week.memory_verse_comment %>
        </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <h1>Choose a Reading Plan</h1>
  <%= form_with model: @plan do |form| %>
    <%= form.label :plan_type, "Plan" %>
    <%= form.select :plan_type, Plan.plan_types.keys.map { |k| [k.humanize.titleize, k] }, { include_blank: "Select a plan", required: true } %>

    <%= form.label :start_date, "Start date" %>
    <%= form.date_field :start_date, value: Date.today, required: true %>
    <p class="text-sm text-neutral-500 -mt-2">You can change this at any time.</p>
    <br />
    <%= form.submit "Get Started" %>
  <% end %>
<% end %>
